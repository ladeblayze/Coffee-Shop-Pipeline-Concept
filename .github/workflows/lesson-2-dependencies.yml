name: Lesson 2 - Job Dependencies (Full Day)

on:
  workflow_dispatch:
    inputs:
      location:
        description: "Which store?"
        type: choice
        required: true
        options:
          - downtown
          - airport
          - mall

jobs:
  # Job 1: Runs first
  morning-prep:
    name: "Step 1: Morning Prep (6 AM)"
    runs-on: ubuntu-latest
    steps:
      - name: Arrive at store
        run: |
          echo "ğŸŒ… Good morning! Arriving at ${{ inputs.location }} store"
          echo "ğŸ• Time: 6:00 AM"
      
      - name: Setup for the day
        run: |
          echo "ğŸ’¡ Turning on lights"
          echo "â˜• Starting coffee machines"
          echo "ğŸ§¹ Quick clean before opening"
          echo "âœ… Store is ready!"

  # Job 2: Waits for morning-prep to finish
  open-store:
    name: "Step 2: Open Store (7 AM)"
    runs-on: ubuntu-latest
    needs: morning-prep  # â† WAITS for morning-prep to complete
    steps:
      - name: Open for business
        run: |
          echo "ğŸšª Unlocking doors..."
          echo "ğŸ”“ Turning off alarm"
          echo "â˜• First pot of coffee brewing"
          echo "âœ… ${{ inputs.location }} store is now OPEN!"

  # Job 3: Waits for open-store to finish
  morning-rush:
    name: "Step 3: Morning Rush (7-11 AM)"
    runs-on: ubuntu-latest
    needs: open-store  # â† WAITS for open-store
    steps:
      - name: Serve morning customers
        run: |
          echo "ğŸ‘¥ Morning rush in progress..."
          
          for i in {1..5}; do
            echo "â˜• Making order #$i..."
            sleep 1
          done
          
          echo "âœ… Morning rush complete!"

  # Job 4: Waits for morning-rush
  lunch-rush:
    name: "Step 4: Lunch Rush (11 AM - 2 PM)"
    runs-on: ubuntu-latest
    needs: morning-rush  # â† WAITS for morning-rush
    steps:
      - name: Prepare for lunch crowd
        run: |
          echo "ğŸ½ï¸ Lunch rush starting..."
          echo "â˜• Brewing extra coffee"
          echo "ğŸ¥ª Restocking sandwiches"
      
      - name: Serve lunch customers
        run: |
          if [ "${{ inputs.location }}" == "downtown" ]; then
            echo "ğŸ¢ Office workers flooding in - 50+ customers!"
          else
            echo "ğŸ‘¥ Steady lunch crowd - 30 customers"
          fi
          echo "âœ… Lunch rush handled!"

  # Job 5: Waits for lunch-rush
  afternoon-shift:
    name: "Step 5: Afternoon (2-6 PM)"
    runs-on: ubuntu-latest
    needs: lunch-rush  # â† WAITS for lunch-rush
    steps:
      - name: Afternoon duties
        run: |
          echo "ğŸ§¹ Cleaning from lunch rush..."
          echo "ğŸ“¦ Restocking supplies"
          echo "â˜• Brewing fresh coffee for afternoon customers"
          echo "âœ… Ready for afternoon crowd"

  # Job 6: Waits for afternoon-shift
  closing-time:
    name: "Step 6: Closing (6-7 PM)"
    runs-on: ubuntu-latest
    needs: afternoon-shift  # â† WAITS for afternoon-shift
    steps:
      - name: Close the store
        run: |
          echo "ğŸŒ™ Starting closing procedures..."
          echo "ğŸ§¹ Deep cleaning equipment"
          echo "ğŸ’° Counting register"
          echo "ğŸ”’ Securing the store"
          echo "âœ… ${{ inputs.location }} store closed successfully!"
      
      - name: End of day summary
        run: |
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“Š END OF DAY REPORT"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "Location: ${{ inputs.location }}"
          echo "Date: $(date +%Y-%m-%d)"
          echo "Opening: 7:00 AM"
          echo "Closing: 7:00 PM"
          echo "Status: âœ… Successful day!"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
